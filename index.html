<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="/style.css" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Doto:wght@100..900&display=swap" rel="stylesheet">
	<title>Benalleng</title>
</head>

<body>
	<h1 class="name-header">Ben Allen G</h1>
	<div class="ticker">
		<hr />
		<p class="marquee">
			<span id="marquee"></span>
		</p>
		<p class="marquee marquee2">
			<span id="marquee2"></span>
		</p>
		<br />
		<hr />
	</div>
	<div class="container">
		<div class="dashboard">
			<a class="link" target="_blank" href="/bitcoin.pdf">bitcoin pdf</a>
			<a class="link" target="_blank" href="/gpg.txt">GPG public key</a>
			<a class="link" href="mailto:benalleng@gmail.com">Contact</a>
			<a class="link" target="_blank" href="https://github.com/benalleng">Github</a>
		</div>
		<div class="content-main">
			<p class="paragraph-main">
				<span class="paragraph-internal first">You've found me, Nice.</span>
				<span class="paragraph-internal">I'm working on expanding the Privacy and fungibility of
					bitcoin</span>
				<span class="paragraph-internal">As well as exploring the securtiy vulernabilities
					through program logic and chaos</span>
				<span class="paragraph-internal">s</span>
				<span class="paragraph-internal">ss</span>
				<span class="paragraph-internal">sss</span>
				<span class="paragraph-internal">ssss</span>
				<span class="paragraph-internal">sssss</span>
				<span class="paragraph-internal">ssssss</span>
				<span id="paragraph-final" class="paragraph-internal last">Updated on </span>
			</p>
		</div>
	</div>
</body>

<script>
	$(document).ready(function () {
		function updateData() {
			var miningAdjutmentPath = "https://mempool.space/api/v1/difficulty-adjustment";
			var pricePath = "https://mempool.space/api/v1/prices";
			let blockTipHeightPath = "https://mempool.space/api/blocks/tip/height";
			let recommendedFeePath = "https://mempool.space/api/v1/fees/recommended";

			$.when(
				$.getJSON(miningAdjutmentPath),
				$.getJSON(pricePath),
				$.getJSON(blockTipHeightPath),
				$.getJSON(recommendedFeePath),
			).done(function (miningData, priceData, blockHeightData, recommendedFeeData) {
				var priceTextContent = "Bitcoin Price" + " - " + "$" + JSON.stringify(priceData[0].USD) + " - " + "Sats per Dollar" + " - " + JSON.stringify(Math.round(100000000 / priceData[0].USD)) + " -\u00A0";

				var difficultyTextContent = "Estimated Difficulty Change" + " - " + JSON.stringify(parseFloat(miningData[0].difficultyChange.toFixed(1))) + "%" + " - " + "Retarget Height" + " - " + JSON.stringify(miningData[0].nextRetargetHeight) + " - " + "Blocks to Retarget" + " - " + JSON.stringify(miningData[0].remainingBlocks) + " -\u00A0";

				var blockTipHeightContent = "Current Block Height" + " - " + JSON.stringify(blockHeightData[0]) + " -\u00A0";

				var recommendedFeeContent = "Minumum Fee" + " - " + JSON.stringify(recommendedFeeData[0].minimumFee) + " sats/vb" + " - " + "Fastest Fee" + " - " + JSON.stringify(recommendedFeeData[0].fastestFee) + " sats/vb" + " -\u00A0";

				var combinedTextContent = priceTextContent + difficultyTextContent + blockTipHeightContent + recommendedFeeContent;

				$("#marquee").empty().append(combinedTextContent);
				$("#marquee2").empty().append(combinedTextContent);
			}).fail(function () {
				console.error("Failed to fetch data from one of the APIs.");
			});
		}

		function fetchCommit() {
			var githubRepoPath = "https://api.github.com/repos/benalleng/benalleng.github.io/commits/master"

			$.when($.getJSON(githubRepoPath)).done(
				function (githubRepoData) {
					var commitDate = new Date(githubRepoData.commit.author.date).toLocaleDateString("en-US", {
						month: "long",
						day: "numeric",
						year: "numeric"
					});

					$("#paragraph-final").append(commitDate);
				}
			)
		}

		fetchCommit();
		updateData();
		setInterval(updateData, 30000);
	});
</script>

</html>
